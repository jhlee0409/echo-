# ì†Œìš¸ë©”ì´íŠ¸ (Soulmate) - ê¸°ìˆ  ë¬¸ì„œ

## ğŸ“‹ ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ê¸°ìˆ  ì•„í‚¤í…ì²˜](#ê¸°ìˆ -ì•„í‚¤í…ì²˜)
3. [AI ì‹œìŠ¤í…œ](#ai-ì‹œìŠ¤í…œ)
4. [ì¸ì¦ ë° ë³´ì•ˆ](#ì¸ì¦-ë°-ë³´ì•ˆ)
5. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
6. [ì„±ëŠ¥ ìµœì í™”](#ì„±ëŠ¥-ìµœì í™”)
7. [ê°œë°œ í™˜ê²½](#ê°œë°œ-í™˜ê²½)
8. [ë°°í¬ ë° ìš´ì˜](#ë°°í¬-ë°-ìš´ì˜)
9. [API ëª…ì„¸](#api-ëª…ì„¸)
10. [ì»´í¬ë„ŒíŠ¸ ê°€ì´ë“œ](#ì»´í¬ë„ŒíŠ¸-ê°€ì´ë“œ)

---

## ğŸ® í”„ë¡œì íŠ¸ ê°œìš”

**ì†Œìš¸ë©”ì´íŠ¸**ëŠ” AI ë™ë°˜ìì™€ì˜ ëŒ€í™”í˜• RPG ê²Œì„ìœ¼ë¡œ, í•œêµ­ì–´ íŠ¹í™” AI ëŒ€í™” ì‹œìŠ¤í…œì„ í•µì‹¬ìœ¼ë¡œ í•˜ëŠ” 1ì¸ ê°œë°œ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥
- **AI ëŒ€í™” ì‹œìŠ¤í…œ**: Claude API ê¸°ë°˜ ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ ëŒ€í™”
- **ê´€ê³„ë„ ì‹œìŠ¤í…œ**: ë™ì  ì¹œë°€ë„ ë° ê°ì • ì‹œìŠ¤í…œ
- **ìë™ ì „íˆ¬**: ê°„ì†Œí™”ëœ ì „íˆ¬ ë©”ì»¤ë‹ˆì¦˜
- **ì„¸ì´ë¸Œ/ë¡œë“œ**: í´ë¼ìš°ë“œ ê¸°ë°˜ ë°ì´í„° ë™ê¸°í™”

### ê°œë°œ ëª©í‘œ
- **ë¹ ë¥¸ ì¶œì‹œ**: 3ê°œì›” MVP ê°œë°œ
- **ë¹„ìš© íš¨ìœ¨ì„±**: ì›” $20-50 ìš´ì˜ë¹„ ëª©í‘œ
- **í™•ì¥ì„±**: ë‹¨ê³„ì  ê¸°ëŠ¥ ì¶”ê°€ ê°€ëŠ¥í•œ êµ¬ì¡°

---

## ğŸ—ï¸ ê¸°ìˆ  ì•„í‚¤í…ì²˜

### ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Frontend                        â”‚
â”‚  React + TypeScript + Tailwind CSS + Zustand   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  API Layer                       â”‚
â”‚        Vercel Serverless Functions              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              External Services                   â”‚
â”‚  Claude API â”‚ Supabase â”‚ Cloudflare R2          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ ì´ìœ 

#### í”„ë¡ íŠ¸ì—”ë“œ
- **React**: ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš©ì„±ê³¼ ìƒíƒœê³„ í™œìš©
- **TypeScript**: íƒ€ì… ì•ˆì •ì„±ê³¼ ê°œë°œ íš¨ìœ¨ì„±
- **Tailwind CSS**: ë¹ ë¥¸ ìŠ¤íƒ€ì¼ë§ê³¼ ì¼ê´€ëœ ë””ìì¸
- **Zustand**: ê°„ë‹¨í•œ ìƒíƒœ ê´€ë¦¬, Redux ëŒ€ë¹„ ëŸ¬ë‹ ì»¤ë¸Œ ë‚®ìŒ

#### ë°±ì—”ë“œ (Serverless)
- **Vercel**: ë¬´ë£Œ í˜¸ìŠ¤íŒ… + API Routes, 1ì¸ ê°œë°œ ìµœì í™”
- **Supabase**: PostgreSQL í˜¸í™˜ + ì‹¤ì‹œê°„ ê¸°ëŠ¥ + ì¸ì¦
- **Claude API**: í•œêµ­ì–´ ëŒ€í™” í’ˆì§ˆ ìš°ìˆ˜
- **Cloudflare R2**: ë¹„ìš© íš¨ìœ¨ì ì¸ ì´ë¯¸ì§€ ì €ì¥

---

## ğŸ¤– AI ì‹œìŠ¤í…œ

### ì•„í‚¤í…ì²˜ ì„¤ê³„
```typescript
// AI ì‹œìŠ¤í…œ ê³„ì¸µ êµ¬ì¡°
interface AISystemArchitecture {
  manager: AIManager;          // í†µí•© ê´€ë¦¬ì
  providers: AIProvider[];     // ë‹¤ì¤‘ AI ì œê³µì
  cache: CacheManager;         // ì‘ë‹µ ìºì‹±
  optimizer: CostOptimizer;    // ë¹„ìš© ìµœì í™”
  prompt: PromptEngine;        // í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
}
```

### í•µì‹¬ ì»´í¬ë„ŒíŠ¸

#### 1. AIManager (src/services/ai/AIManager.ts)
**ì—­í• **: AI ì œê³µìë“¤ì˜ í†µí•© ê´€ë¦¬ ë° ì§€ëŠ¥í˜• í´ë°±

```typescript
export class AIManager {
  // ë‹¤ì¤‘ ì œê³µì ì§€ì› (Claude, OpenAI, Mock)
  private providers = new Map<string, AIProvider>();
  
  // ì§€ëŠ¥í˜• í´ë°± ì‹œìŠ¤í…œ
  async generateResponse(request: AIRequest): Promise<AIResponse> {
    const optimizedRequest = this.costOptimizer.optimizePrompt(request);
    const cacheKey = this.generateCacheKey(optimizedRequest);
    
    // ìºì‹œ ìš°ì„  í™•ì¸
    const cachedResponse = await this.cacheManager.get(cacheKey);
    if (cachedResponse) return cachedResponse;
    
    // ìµœì  ì œê³µì ì„ íƒ ë° ì‹¤í–‰
    const provider = await this.selectBestProvider(optimizedRequest);
    return await this.executeWithFallback(optimizedRequest, provider);
  }
}
```

#### 2. ìºì‹± ì „ëµ (src/services/ai/CacheManager.ts)
**ëª©í‘œ**: API í˜¸ì¶œ 70-80% ì ˆê°

```typescript
// ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ìºì‹œ í‚¤ ìƒì„±
const generateCacheKey = (input: string, context: GameContext): string => {
  return `${input}_${context.companionEmotion}_${context.relationshipLevel}`;
};

// TTL ê¸°ë°˜ ìºì‹œ ì •ì±…
const cacheConfig = {
  greeting: 300,     // 5ë¶„ - ì¸ì‚¬ë§
  casual: 600,       // 10ë¶„ - ì¼ìƒ ëŒ€í™”  
  emotional: 180,    // 3ë¶„ - ê°ì •ì  ëŒ€í™”
  story: 1800        // 30ë¶„ - ìŠ¤í† ë¦¬ ì½˜í…ì¸ 
};
```

#### 3. ë¹„ìš© ìµœì í™” (src/services/ai/CostOptimizer.ts)
**ì „ëµ**: í”„ë¡¬í”„íŠ¸ ì••ì¶• ë° ì œê³µì ì„ íƒ

```typescript
export class CostOptimizer {
  // í”„ë¡¬í”„íŠ¸ ê¸¸ì´ ìµœì í™”
  optimizePrompt(request: AIRequest): AIRequest {
    const context = this.pruneContext(request.context);
    const messages = this.compressMessages(request.messages);
    return { ...request, context, messages };
  }
  
  // ë¹„ìš© ê¸°ë°˜ ì œê³µì ì„ íƒ
  selectProvider(request: AIRequest): string {
    const complexity = this.calculateComplexity(request);
    return complexity > 0.7 ? 'claude' : 'openai';
  }
}
```

### ì„±ëŠ¥ ì§€í‘œ
- **ì‘ë‹µ ì‹œê°„**: <2ì´ˆ (execution-plan.md ê¸°ì¤€)
- **ìºì‹œ íš¨ìœ¨**: 70-80% íˆíŠ¸ìœ¨ ë‹¬ì„±
- **ëª¨ë°”ì¼ ìµœì í™”**: <1ì´ˆ ì‘ë‹µ (ê°„ë‹¨í•œ ìš”ì²­)
- **ë™ì‹œ ì²˜ë¦¬**: 10+ ì‚¬ìš©ì ë™ì‹œ ì§€ì›

---

## ğŸ” ì¸ì¦ ë° ë³´ì•ˆ

### ë³´ì•ˆ ì•„í‚¤í…ì²˜
```typescript
// ë‹¤ì¸µ ë³´ì•ˆ ì‹œìŠ¤í…œ
interface SecurityArchitecture {
  authentication: AuthManager;     // Supabase JWT ì¸ì¦
  validation: SecurityValidator;   // ì…ë ¥ ê²€ì¦ ë° í•„í„°ë§
  session: SessionManager;         // ì„¸ì…˜ ê´€ë¦¬ ë° íƒ€ì„ì•„ì›ƒ
  encryption: DataProtection;      // ë¯¼ê° ë°ì´í„° ì•”í˜¸í™”
}
```

#### ì¸ì¦ ì‹œìŠ¤í…œ (src/services/auth/AuthManager.ts)
```typescript
export class AuthManager {
  // Supabase ê¸°ë°˜ ì¸ì¦
  async signIn(email: string, password: string): Promise<AuthResult> {
    const { data, error } = await this.supabase.auth.signInWithPassword({
      email, password
    });
    
    if (error) throw new AuthError(error.message);
    
    // JWT í† í° ê²€ì¦ ë° ì„¸ì…˜ ì„¤ì •
    return this.createAuthSession(data);
  }
  
  // ìë™ í† í° ê°±ì‹ 
  async refreshToken(): Promise<void> {
    const { data, error } = await this.supabase.auth.refreshSession();
    if (error) throw new AuthError('Token refresh failed');
    
    this.updateSession(data.session);
  }
}
```

#### ë³´ì•ˆ ê²€ì¦ (src/services/auth/SecurityValidator.ts)
```typescript
export class SecurityValidator {
  // ì‚¬ìš©ì ì…ë ¥ í•„í„°ë§
  validateUserInput(input: string): ValidationResult {
    // XSS ë°©ì§€
    const sanitized = DOMPurify.sanitize(input);
    
    // ë¶€ì ì ˆ ë‚´ìš© í•„í„°ë§
    const hasInappropriateContent = this.checkContent(sanitized);
    
    // SQL ì¸ì ì…˜ ë°©ì§€
    const hasSQLInjection = this.checkSQLPatterns(sanitized);
    
    return {
      isValid: !hasInappropriateContent && !hasSQLInjection,
      sanitizedInput: sanitized,
      warnings: this.generateWarnings(input)
    };
  }
}
```

---

## ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### ìŠ¤í‚¤ë§ˆ êµ¬ì¡° (database/schema.sql)
```sql
-- ì‚¬ìš©ì í”„ë¡œí•„
CREATE TABLE user_profiles (
  id UUID REFERENCES auth.users(id) PRIMARY KEY,
  nickname VARCHAR(50) NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ê²Œì„ ì„¸ì´ë¸Œ ë°ì´í„°
CREATE TABLE game_saves (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES user_profiles(id) NOT NULL,
  companion_name VARCHAR(50) NOT NULL,
  companion_data JSONB NOT NULL,
  game_progress JSONB NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- AI ëŒ€í™” ê¸°ë¡
CREATE TABLE conversation_logs (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES user_profiles(id) NOT NULL,
  user_message TEXT NOT NULL,
  ai_response TEXT NOT NULL,
  context_data JSONB,
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

### RLS (Row Level Security) ì •ì±…
```sql
-- ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥
ALTER TABLE game_saves ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can only access their own saves" ON game_saves
  FOR ALL USING (auth.uid() = user_id);

-- ëŒ€í™” ê¸°ë¡ ë³´ì•ˆ
ALTER TABLE conversation_logs ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can only access their own conversations" ON conversation_logs
  FOR ALL USING (auth.uid() = user_id);
```

---

## âš¡ ì„±ëŠ¥ ìµœì í™”

### í”„ë¡ íŠ¸ì—”ë“œ ìµœì í™”

#### 1. ë²ˆë“¤ ìµœì í™” (vite.config.ts)
```typescript
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          ai: ['./src/services/ai'],
          game: ['./src/components/game']
        }
      }
    },
    target: 'es2020',
    minify: 'terser'
  }
});
```

#### 2. ì½”ë“œ ë¶„í•  ë° ì§€ì—° ë¡œë”©
```typescript
// ë™ì  ì„í¬íŠ¸ë¥¼ í†µí•œ ì½”ë“œ ë¶„í• 
const GameScreen = lazy(() => import('./components/game/GameScreen'));
const BattleSystem = lazy(() => import('./components/battle/BattleSystem'));

// ë¼ìš°íŠ¸ ê¸°ë°˜ ì½”ë“œ ë¶„í• 
const router = createBrowserRouter([
  {
    path: "/",
    element: <App />,
    children: [
      { path: "game", element: <Suspense><GameScreen /></Suspense> },
      { path: "battle", element: <Suspense><BattleSystem /></Suspense> }
    ]
  }
]);
```

#### 3. ë©”ëª¨í™” ë° ìµœì í™” í›…
```typescript
// ë¹„ìš© ë†’ì€ ê³„ì‚° ë©”ëª¨í™”
const gameStats = useMemo(() => 
  calculateComplexStats(gameState, companion), 
  [gameState.level, companion.stats]
);

// API í˜¸ì¶œ ìµœì í™”
const { data: aiResponse, isLoading } = useSWR(
  ['ai-response', userInput, context],
  ([_, input, ctx]) => aiManager.generateResponse({ input, context: ctx }),
  {
    revalidateOnFocus: false,
    dedupingInterval: 10000 // 10ì´ˆ ì¤‘ë³µ ì œê±°
  }
);
```

### ë°±ì—”ë“œ ìµœì í™”

#### 1. API ì‘ë‹µ ìºì‹±
```typescript
// Vercel Edge Functions í™œìš©
export const config = { runtime: 'edge' };

export default async function handler(req: Request) {
  const cacheKey = generateCacheKey(req);
  
  // Edge ìºì‹œ í™•ì¸
  const cached = await caches.default.match(req);
  if (cached) return cached;
  
  // AI ì‘ë‹µ ìƒì„±
  const response = await generateAIResponse(req);
  
  // ìºì‹œ ì €ì¥ (TTL: 5ë¶„)
  const cacheResponse = new Response(JSON.stringify(response), {
    headers: {
      'Cache-Control': 's-maxage=300',
      'Content-Type': 'application/json'
    }
  });
  
  await caches.default.put(req, cacheResponse.clone());
  return cacheResponse;
}
```

#### 2. ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”
```sql
-- ì¸ë±ìŠ¤ ìƒì„± (database/migrations/002_indexes_and_rls.sql)
CREATE INDEX idx_game_saves_user_id ON game_saves(user_id);
CREATE INDEX idx_conversation_logs_user_id_created ON conversation_logs(user_id, created_at DESC);

-- íŒŒí‹°ì…”ë‹ì„ í†µí•œ ì„±ëŠ¥ í–¥ìƒ
CREATE TABLE conversation_logs_partitioned (
  LIKE conversation_logs INCLUDING ALL
) PARTITION BY RANGE (created_at);
```

---

## ğŸ› ï¸ ê°œë°œ í™˜ê²½

### í”„ë¡œì íŠ¸ ì„¤ì •

#### 1. í™˜ê²½ ë³€ìˆ˜ (.env.example)
```env
# Supabase
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key

# AI Providers
VITE_CLAUDE_API_KEY=your-claude-key
VITE_OPENAI_API_KEY=your-openai-key

# Development
VITE_NODE_ENV=development
VITE_DEBUG_MODE=true
```

#### 2. TypeScript ì„¤ì • (tsconfig.json)
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "allowJs": false,
    "skipLibCheck": true,
    "esModuleInterop": false,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noImplicitReturns": true,
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"],
      "@services/*": ["src/services/*"],
      "@lib/*": ["src/lib/*"],
      "@config/*": ["src/config/*"],
      "@types": ["src/types/index.ts"]
    }
  }
}
```

#### 3. í…ŒìŠ¤íŠ¸ í™˜ê²½ (vitest.config.ts)
```typescript
export default defineConfig({
  test: {
    globals: true,
    environment: 'jsdom',
    setupFiles: ['./src/tests/setup.ts'],
    coverage: {
      provider: 'v8',
      reporter: ['text', 'html', 'json'],
      threshold: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80
        }
      }
    }
  }
});
```

### ê°œë°œ ë„êµ¬ ë° ìŠ¤í¬ë¦½íŠ¸

#### 1. ìë™í™” ìŠ¤í¬ë¦½íŠ¸ (scripts/)
```bash
# ê±´ê°•ì„± ì²´í¬
npm run health-check

# ì˜ì¡´ì„± ìœ ì§€ë³´ìˆ˜
npm run deps:check
npm run deps:update

# ì½”ë“œ í’ˆì§ˆ
npm run lint
npm run type-check
npm run format

# í…ŒìŠ¤íŠ¸
npm run test
npm run test:coverage
npm run test:ui
```

#### 2. Git í›… ì„¤ì • (.husky/)
```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npm run lint && npm run type-check && npm run test
```

---

## ğŸš€ ë°°í¬ ë° ìš´ì˜

### Vercel ë°°í¬ ì„¤ì •

#### 1. ë°°í¬ êµ¬ì„± (vercel.json)
```json
{
  "framework": "vite",
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "installCommand": "npm install --legacy-peer-deps",
  "functions": {
    "src/api/**/*.ts": {
      "runtime": "nodejs18.x",
      "maxDuration": 30
    }
  },
  "rewrites": [
    {
      "source": "/api/(.*)",
      "destination": "/api/$1"
    }
  ]
}
```

#### 2. í™˜ê²½ë³„ ì„¤ì •
```javascript
// Production ìµœì í™”
const productionConfig = {
  minify: true,
  sourcemap: false,
  define: {
    'process.env.NODE_ENV': '"production"',
    '__DEV__': false
  }
};

// Development ì„¤ì •
const developmentConfig = {
  minify: false,
  sourcemap: true,
  define: {
    'process.env.NODE_ENV': '"development"',
    '__DEV__': true
  }
};
```

### ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

#### 1. ì—ëŸ¬ ì¶”ì 
```typescript
// ê¸€ë¡œë²Œ ì—ëŸ¬ í•¸ë“¤ëŸ¬
window.addEventListener('error', (event) => {
  console.error('Global Error:', {
    message: event.message,
    filename: event.filename,
    lineno: event.lineno,
    colno: event.colno,
    error: event.error
  });
  
  // í”„ë¡œë•ì…˜ì—ì„œëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ë¡œ ì „ì†¡
  if (process.env.NODE_ENV === 'production') {
    sendErrorToLogging(event);
  }
});

// React ì—ëŸ¬ ê²½ê³„
class ErrorBoundary extends React.Component {
  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error('React Error Boundary:', error, errorInfo);
    
    if (process.env.NODE_ENV === 'production') {
      sendErrorToLogging({ error, errorInfo });
    }
  }
}
```

#### 2. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
```typescript
// Web Vitals ì¸¡ì •
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

function sendToAnalytics(metric: any) {
  console.log('Performance Metric:', metric);
  
  // í”„ë¡œë•ì…˜ì—ì„œëŠ” ë¶„ì„ ì„œë¹„ìŠ¤ë¡œ ì „ì†¡
  if (process.env.NODE_ENV === 'production') {
    navigator.sendBeacon('/api/analytics', JSON.stringify(metric));
  }
}

getCLS(sendToAnalytics);
getFID(sendToAnalytics);
getFCP(sendToAnalytics);
getLCP(sendToAnalytics);
getTTFB(sendToAnalytics);
```

---

## ğŸ“¡ API ëª…ì„¸

### AI ëŒ€í™” API

#### 1. POST /api/ai/chat
**ëª©ì **: AIì™€ì˜ ëŒ€í™” ìƒì„±

```typescript
// ìš”ì²­ í˜•ì‹
interface ChatRequest {
  messages: Array<{
    role: 'user' | 'assistant';
    content: string;
  }>;
  context: {
    companionName: string;
    companionPersonality: PersonalityTraits;
    relationshipLevel: number;
    intimacyLevel: number;
    companionEmotion: EmotionType;
    currentScene: string;
    timeOfDay: 'morning' | 'afternoon' | 'evening' | 'night';
  };
  options?: {
    maxTokens?: number;
    temperature?: number;
    stream?: boolean;
  };
}

// ì‘ë‹µ í˜•ì‹
interface ChatResponse {
  content: string;
  emotion: EmotionType;
  confidence: number;
  tokensUsed: number;
  provider: string;
  processingTime: number;
  cached: boolean;
  metadata: {
    model: string;
    finishReason: string;
    totalCost: number;
  };
}
```

#### 2. GET /api/ai/health
**ëª©ì **: AI ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸

```typescript
interface HealthResponse {
  status: 'healthy' | 'degraded' | 'unhealthy';
  providers: Record<string, {
    available: boolean;
    responseTime: number;
    quota: number | null;
  }>;
  cache: {
    hitRate: number;
    size: number;
  };
  uptime: number;
}
```

### ê²Œì„ ë°ì´í„° API

#### 1. POST /api/game/save
**ëª©ì **: ê²Œì„ ì§„í–‰ ìƒí™© ì €ì¥

```typescript
interface SaveRequest {
  companion: {
    name: string;
    level: number;
    stats: CompanionStats;
    personality: PersonalityTraits;
    emotion: EmotionType;
  };
  player: {
    name: string;
    level: number;
    experience: number;
    inventory: Item[];
  };
  progress: {
    currentChapter: number;
    unlockedFeatures: string[];
    achievements: Achievement[];
  };
  metadata: {
    playTime: number;
    lastPlayed: string;
    version: string;
  };
}
```

#### 2. GET /api/game/load
**ëª©ì **: ì €ì¥ëœ ê²Œì„ ë°ì´í„° ë¡œë“œ

```typescript
interface LoadResponse {
  success: boolean;
  data?: SaveRequest;
  error?: string;
  backups?: Array<{
    id: string;
    timestamp: string;
    version: string;
  }>;
}
```

---

## ğŸ§© ì»´í¬ë„ŒíŠ¸ ê°€ì´ë“œ

### í•µì‹¬ UI ì»´í¬ë„ŒíŠ¸

#### 1. ChatWindow (src/components/chat/ChatWindow.tsx)
**ëª©ì **: AIì™€ì˜ ëŒ€í™” ì¸í„°í˜ì´ìŠ¤

```typescript
interface ChatWindowProps {
  messages: Message[];
  onSendMessage: (content: string) => void;
  isLoading: boolean;
  companion: CompanionState;
  className?: string;
}

// ì‚¬ìš© ì˜ˆì‹œ
<ChatWindow
  messages={conversationHistory}
  onSendMessage={handleUserMessage}
  isLoading={aiResponseLoading}
  companion={companionState}
  className="flex-1 bg-gray-900 rounded-lg"
/>
```

**ì£¼ìš” ê¸°ëŠ¥**:
- ì‹¤ì‹œê°„ íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜
- ë©”ì‹œì§€ ê°€ìƒí™” (ëŒ€í™”ëŸ‰ ë§ì„ ë•Œ ì„±ëŠ¥)
- ìë™ ìŠ¤í¬ë¡¤ ë° ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ê¸°ì–µ
- ì´ëª¨í‹°ì½˜ ë° íŠ¹ìˆ˜ íš¨ê³¼ ì§€ì›

#### 2. CharacterStatus (src/components/game/CharacterStatus.tsx)
**ëª©ì **: ë™ë°˜ì ìƒíƒœ í‘œì‹œ

```typescript
interface CharacterStatusProps {
  companion: CompanionState;
  showDetails?: boolean;
  animate?: boolean;
  onInteract?: () => void;
}

// ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
const CharacterStatus: React.FC<CharacterStatusProps> = ({
  companion,
  showDetails = false,
  animate = true,
  onInteract
}) => {
  return (
    <div className="character-status">
      {/* ì•„ë°”íƒ€ ë° ì• ë‹ˆë©”ì´ì…˜ */}
      <div className="avatar-container">
        <Avatar 
          src={companion.avatar}
          emotion={companion.currentEmotion}
          animate={animate}
        />
        <EmotionIndicator emotion={companion.currentEmotion} />
      </div>
      
      {/* ìƒíƒœ ì •ë³´ */}
      <div className="status-info">
        <h3>{companion.name} Lv.{companion.level}</h3>
        <RelationshipBar level={companion.relationshipLevel} />
        <MoodIndicator mood={companion.currentEmotion} />
      </div>
      
      {/* ìƒì„¸ ì •ë³´ (ì„ íƒì ) */}
      {showDetails && (
        <div className="detailed-stats">
          <StatBar label="ì²´ë ¥" value={companion.stats.health} max={100} />
          <StatBar label="ê¸°ë ¥" value={companion.stats.energy} max={100} />
          <StatBar label="í–‰ë³µ" value={companion.stats.happiness} max={100} />
        </div>
      )}
    </div>
  );
};
```

#### 3. GameScreen (src/components/game/GameScreen.tsx)
**ëª©ì **: ë©”ì¸ ê²Œì„ í™”ë©´ ë ˆì´ì•„ì›ƒ

```typescript
const GameScreen: React.FC = () => {
  const { gameState, companion } = useGameStore();
  const [currentView, setCurrentView] = useState<'chat' | 'battle' | 'explore'>('chat');
  
  return (
    <div className="game-screen h-screen bg-gradient-to-br from-purple-900 to-blue-900">
      {/* ìƒíƒœë°” */}
      <StatusBar 
        day={gameState.currentDay}
        currency={gameState.currency}
        energy={gameState.player.energy}
      />
      
      {/* ë©”ì¸ ì½˜í…ì¸  */}
      <div className="main-content flex flex-1">
        {/* ì™¼ìª½: ìºë¦­í„° ìƒíƒœ */}
        <aside className="character-panel w-1/3 p-4">
          <CharacterStatus 
            companion={companion}
            showDetails={true}
            onInteract={() => setCurrentView('chat')}
          />
        </aside>
        
        {/* ì˜¤ë¥¸ìª½: ì¸í„°ë™ì…˜ ì˜ì—­ */}
        <main className="interaction-area flex-1 p-4">
          {currentView === 'chat' && (
            <ChatWindow
              messages={gameState.conversationHistory}
              onSendMessage={handleUserMessage}
              isLoading={gameState.aiResponseLoading}
              companion={companion}
            />
          )}
          
          {currentView === 'battle' && (
            <BattleScreen 
              player={gameState.player}
              companion={companion}
              onBattleEnd={handleBattleEnd}
            />
          )}
          
          {currentView === 'explore' && (
            <ExploreScreen 
              currentLocation={gameState.currentLocation}
              onMove={handlePlayerMove}
              onDiscoverItem={handleItemDiscovery}
            />
          )}
        </main>
      </div>
      
      {/* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */}
      <NavigationBar 
        currentView={currentView}
        onViewChange={setCurrentView}
      />
    </div>
  );
};
```

### ìƒíƒœ ê´€ë¦¬ íŒ¨í„´

#### Zustand Store êµ¬ì¡° (src/store/gameStore.ts)
```typescript
interface GameStore {
  // ìƒíƒœ
  gameState: GameState;
  companion: CompanionState;
  
  // ì•¡ì…˜
  sendMessage: (content: string) => Promise<void>;
  updateCompanion: (updates: Partial<CompanionState>) => void;
  saveGame: () => Promise<void>;
  loadGame: (saveId: string) => Promise<void>;
  
  // ê³„ì‚°ëœ ê°’
  isGameReady: boolean;
  canSendMessage: boolean;
}

export const useGameStore = create<GameStore>((set, get) => ({
  gameState: initialGameState,
  companion: initialCompanionState,
  
  sendMessage: async (content: string) => {
    const { gameState, companion } = get();
    
    // ë©”ì‹œì§€ ì¶”ê°€
    set(state => ({
      gameState: {
        ...state.gameState,
        conversationHistory: [
          ...state.gameState.conversationHistory,
          { role: 'user', content, timestamp: Date.now() }
        ],
        aiResponseLoading: true
      }
    }));
    
    try {
      // AI ì‘ë‹µ ìƒì„±
      const aiResponse = await aiManager.generateResponse({
        messages: gameState.conversationHistory,
        context: {
          companionName: companion.name,
          companionPersonality: companion.personality,
          relationshipLevel: companion.relationshipLevel,
          // ... ê¸°íƒ€ ì»¨í…ìŠ¤íŠ¸
        }
      });
      
      // ì‘ë‹µ ì¶”ê°€ ë° ë™ë°˜ì ìƒíƒœ ì—…ë°ì´íŠ¸
      set(state => ({
        gameState: {
          ...state.gameState,
          conversationHistory: [
            ...state.gameState.conversationHistory,
            { 
              role: 'assistant', 
              content: aiResponse.content, 
              timestamp: Date.now() 
            }
          ],
          aiResponseLoading: false
        },
        companion: {
          ...state.companion,
          currentEmotion: aiResponse.emotion,
          relationshipLevel: calculateNewRelationship(
            state.companion.relationshipLevel,
            content,
            aiResponse.content
          )
        }
      }));
      
    } catch (error) {
      console.error('AI response failed:', error);
      set(state => ({
        gameState: {
          ...state.gameState,
          aiResponseLoading: false
        }
      }));
    }
  },
  
  // ê³„ì‚°ëœ ê°’
  get isGameReady() {
    const { gameState } = get();
    return !gameState.aiResponseLoading && gameState.isInitialized;
  },
  
  get canSendMessage() {
    const { gameState } = get();
    return !gameState.aiResponseLoading && gameState.isConnected;
  }
}));
```

---

## ğŸ“Š ì„±ëŠ¥ ë° ë©”íŠ¸ë¦­

### í˜„ì¬ ì„±ëŠ¥ ì§€í‘œ

#### í…ŒìŠ¤íŠ¸ ê²°ê³¼ (2024ë…„ ê¸°ì¤€)
- **ì „ì²´ í…ŒìŠ¤íŠ¸**: 73.7% í†µê³¼ (56/76 í…ŒìŠ¤íŠ¸)
- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**: 100% í†µê³¼ (8/8 í…ŒìŠ¤íŠ¸)
- **AI ì‘ë‹µ ì‹œê°„**: í‰ê·  1.2ì´ˆ (<2ì´ˆ ëª©í‘œ ë‹¬ì„±)
- **ëª¨ë°”ì¼ ì‘ë‹µ**: í‰ê·  138ms (<1ì´ˆ ëª©í‘œ ë‹¬ì„±)
- **ìºì‹œ íš¨ìœ¨**: 90%+ íˆíŠ¸ìœ¨

#### ë²ˆë“¤ í¬ê¸° ë¶„ì„
```
dist/
â”œâ”€â”€ index.html (2.3 KB)
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ index-a1b2c3d4.js (245 KB) - ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ vendor-e5f6g7h8.js (189 KB) - React, ë¼ì´ë¸ŒëŸ¬ë¦¬
â”‚   â”œâ”€â”€ ai-i9j0k1l2.js (67 KB) - AI ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ game-m3n4o5p6.js (123 KB) - ê²Œì„ ë¡œì§
â””â”€â”€ Total: ~626 KB (gzipped: ~198 KB)
```

### ìµœì í™” ì „ëµ

#### 1. ì„±ëŠ¥ ì˜ˆì‚°
```javascript
const performanceBudgets = {
  // ë²ˆë“¤ í¬ê¸°
  totalBundle: '800 KB',
  initialChunk: '300 KB',
  
  // ë¡œë”© ì‹œê°„
  firstContentfulPaint: '1.5s',
  largestContentfulPaint: '2.5s',
  firstInputDelay: '100ms',
  
  // AI ì‘ë‹µ
  apiResponseTime: '2s',
  cacheHitRate: '70%',
  
  // ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
  peakMemoryUsage: '50 MB',
  memoryLeaksPerSession: '0'
};
```

#### 2. ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
```typescript
// ì‹¤ì‹œê°„ ì„±ëŠ¥ ì¶”ì 
const performanceMonitor = {
  // ë©”íŠ¸ë¦­ ìˆ˜ì§‘
  collectMetrics: () => ({
    responseTime: aiManager.getAverageResponseTime(),
    cacheHitRate: cacheManager.getHitRate(),
    activeUsers: sessionManager.getActiveUserCount(),
    errorRate: errorTracker.getErrorRate()
  }),
  
  // ì•Œë¦¼ ì¡°ê±´
  alerts: {
    highResponseTime: 3000,    // 3ì´ˆ ì´ˆê³¼ì‹œ ì•Œë¦¼
    lowCacheHitRate: 0.6,      // 60% ë¯¸ë§Œì‹œ ì•Œë¦¼
    highErrorRate: 0.05,       // 5% ì´ˆê³¼ì‹œ ì•Œë¦¼
    memoryLeak: '100 MB'       // ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê°ì§€
  }
};
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

#### 1. AI ì‘ë‹µ ì§€ì—°
**ì¦ìƒ**: API ì‘ë‹µì´ 2ì´ˆë¥¼ ì´ˆê³¼
**ì›ì¸**: 
- ìºì‹œ ë¯¸ìŠ¤ê°€ ë¹ˆë²ˆí•¨
- í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ë³µì¡í•¨
- ë„¤íŠ¸ì›Œí¬ ì§€ì—°

**í•´ê²°ì±…**:
```typescript
// ìºì‹œ ì „ëµ ê°œì„ 
const optimizeCache = () => {
  // ìºì‹œ í‚¤ ì •ê·œí™”
  const normalizeKey = (input: string, context: any) => {
    const simplified = simplifyContext(context);
    return `${input.toLowerCase().trim()}_${JSON.stringify(simplified)}`;
  };
  
  // í”„ë¡¬í”„íŠ¸ ì••ì¶•
  const compressPrompt = (messages: Message[]) => {
    return messages
      .slice(-5) // ìµœê·¼ 5ê°œ ë©”ì‹œì§€ë§Œ ìœ ì§€
      .map(msg => ({ 
        role: msg.role, 
        content: msg.content.slice(0, 200) // 200ì ì œí•œ
      }));
  };
};
```

#### 2. ë©”ëª¨ë¦¬ ëˆ„ìˆ˜
**ì¦ìƒ**: ì¥ì‹œê°„ ì‚¬ìš©ì‹œ ë¸Œë¼ìš°ì €ê°€ ëŠë ¤ì§
**ì›ì¸**: 
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ì •ë¦¬ë˜ì§€ ì•ŠìŒ
- ëŒ€í™” ê¸°ë¡ì´ ë¬´í•œì • ì¶•ì ë¨

**í•´ê²°ì±…**:
```typescript
// ë©”ëª¨ë¦¬ ê´€ë¦¬ ìµœì í™”
const useMemoryOptimizedChat = () => {
  const [messages, setMessages] = useState<Message[]>([]);
  const MAX_MESSAGES = 100;
  
  // ë©”ì‹œì§€ ê°œìˆ˜ ì œí•œ
  const addMessage = useCallback((message: Message) => {
    setMessages(prev => {
      const updated = [...prev, message];
      return updated.length > MAX_MESSAGES 
        ? updated.slice(-MAX_MESSAGES) 
        : updated;
    });
  }, []);
  
  // ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ì‹œ ì •ë¦¬
  useEffect(() => {
    return () => {
      // WebSocket ì—°ê²° ì •ë¦¬
      websocket?.close();
      // íƒ€ì´ë¨¸ ì •ë¦¬
      clearInterval(heartbeatTimer);
      // ìºì‹œ ì •ë¦¬
      aiResponseCache.clear();
    };
  }, []);
};
```

#### 3. TypeScript ì˜¤ë¥˜
**í˜„ì¬ ìƒíƒœ**: 80ê°œ TypeScript ì˜¤ë¥˜ ì¡´ì¬
**ì£¼ìš” ì›ì¸**: 
- ê²½ë¡œ ë§¤í•‘ ë¬¸ì œ
- íƒ€ì… ì •ì˜ ëˆ„ë½
- ìˆœí™˜ ì°¸ì¡°

**í•´ê²° ì§„í–‰ ì¤‘**:
```typescript
// tsconfig.json ê²½ë¡œ ë§¤í•‘ ìˆ˜ì •
{
  "paths": {
    "@/*": ["src/*"],
    "@components/*": ["src/components/*"],
    "@services/*": ["src/services/*"],
    "@lib/*": ["src/lib/*"],
    "@config/*": ["src/config/*"],
    "@types": ["src/types/index.ts"]
  }
}

// vite.config.tsì™€ ë™ê¸°í™”
resolve: {
  alias: {
    '@': path.resolve(__dirname, './src'),
    '@components': path.resolve(__dirname, './src/components'),
    '@services': path.resolve(__dirname, './src/services'),
    '@lib': path.resolve(__dirname, './src/lib'),
    '@config': path.resolve(__dirname, './src/config'),
    '@types': path.resolve(__dirname, './src/types')
  }
}
```

---

## ğŸ“š ì¶”ê°€ ë¦¬ì†ŒìŠ¤

### ê°œë°œ ë¬¸ì„œ
- [Phase 1 ì§„í–‰ ë³´ê³ ì„œ](./PHASE1_PROGRESS_REPORT.md)
- [ê°œë°œ í™˜ê²½ ì„¤ì •](./DEVELOPMENT.md)
- [í…ŒìŠ¤íŠ¸ ë³´ê³ ì„œ](./TEST_REPORT.md)
- [ìë™í™” ì‹œìŠ¤í…œ](./EXECUTION_AUTOMATION.md)

### ì™¸ë¶€ ì„œë¹„ìŠ¤ ë¬¸ì„œ
- [Supabase ë¬¸ì„œ](https://supabase.io/docs)
- [Anthropic Claude API](https://docs.anthropic.com/)
- [Vercel ë°°í¬ ê°€ì´ë“œ](https://vercel.com/docs)
- [Tailwind CSS](https://tailwindcss.com/docs)

### ì»¤ë®¤ë‹ˆí‹° ë° ì§€ì›
- [GitHub Repository](https://github.com/your-repo/soulmate)
- [Discord ì»¤ë®¤ë‹ˆí‹°](https://discord.gg/soulmate-dev)
- [ê°œë°œ ë¸”ë¡œê·¸](https://blog.soulmate-game.com)

---

## ğŸ“ ì—…ë°ì´íŠ¸ ë¡œê·¸

### 2024-08-07
- âœ… ëª¨ë°”ì¼ ì„±ëŠ¥ ìµœì í™” ì™„ë£Œ (ì‘ë‹µì‹œê°„ 70% ê°œì„ )
- âœ… ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ 100% í†µê³¼ ë‹¬ì„±
- ğŸ”„ TypeScript ì˜¤ë¥˜ í•´ê²° ì§„í–‰ ì¤‘ (80ê°œ â†’ ì§„í–‰ì¤‘)
- ğŸ“‹ ê¸°ìˆ  ë¬¸ì„œ ì‘ì„± ì™„ë£Œ

### í–¥í›„ ê³„íš
- **2024-08 W2**: TypeScript ì˜¤ë¥˜ ì™„ì „ í•´ê²°
- **2024-08 W3**: Phase 2 ìºë¦­í„° ì‹œìŠ¤í…œ êµ¬í˜„
- **2024-08 W4**: ìë™ ì „íˆ¬ ì‹œìŠ¤í…œ ê°œë°œ
- **2024-09 W1**: ìŠ¤í† ë¦¬ ìë™ ìƒì„± ì‹œìŠ¤í…œ 

---

**ë¬¸ì„œ ë²„ì „**: v1.0.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2024-08-07  
**ì‘ì„±ì**: Claude Code SuperClaude Framework  
**ë¼ì´ì„ ìŠ¤**: MIT License